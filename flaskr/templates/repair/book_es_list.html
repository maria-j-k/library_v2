{% extends 'base.html' %}
{% from 'bootstrap/pagination.html' import render_pagination %}
    {% block scripts %}
        {{ super() }}
     <script type="text/javascript" src="{{ url_for('static', filename='list_fuzzy.js') }}"></script>
 {% endblock %}
 {% block content %}
     <h1>Fuzzy</h1>
    {{ super() }} 
    <form action="" method="post" accept-charset="utf-8">
    {{ form.hidden_tag() }}
    <div class="container row mb-3">
    <div class="coll-sm-3">
        {{ form.name.label }}
    </div>
    <div class="col-sm-6">
        {{ form.name(class_="form-control search-input") }}
    </div>
    <div class="coll-sm-2">
        <button class="btn btn-light fake search"><a id="search-link" href="{{ url_for('repair.books_list', name="") }}">Search</a></button>
        
    </div>
    {% for error in form.name.errors %}
        <span style="color: red">{{ error }}</span>   
    {% endfor %}
  </div>
<table class="table">
    <thead>
        <tr>
            <th>ID</th>
            <th>Merge</th>
            <th>Semblables</th>
            <th>ISBN</th>
            <th>Title</th>
            <th>Author</th>
            <th>Publisher</th>
            <th>Serie</th>
            <th>Publication place</th>
            <th>Publication date</th>
            <th>N of copies</th>
            <th>Incorrect</th>
            <th>Approuved</th>
        </tr>
    </thead>
    <tbody>
        {#'created_at': '2021-01-17T17:27:34.031075+01:00', 
         'last_modified': '2021-01-17T17:27:34.077897+01:00', 
         'approuved': False, 
         'incorrect': None, 
         'id': 6788, 
         'isbn': None, 
         'title': 'Judeopolonia II', 
         'origin_title': None, 
         'first_print': False, 
         'origin_language': '', 
         'pub_year': '2002', 
         'first_edition': '', 
         'genre': None, 
         'literary_form': None, 
         'fiction': None, 
         'precision': '', 
         'nukat': '', 
         'publisher_id': 1048, 
         'city_id': 195, 
         'serie_id': None, 
         'copies_count': 1, 
         'publisher': 'Polwen', 
         'city': 'Radom', 
         'authors': 'Szcześniak Andrzej Leszek', 
         'authors_ids': [10293]#}

        {% for book in books %}
        <tr>
            <td>{{ book.id }}</td>
            <td>
                <div class="form-check">
                    <input class="form-check-input" name="book_id" type="checkbox" value="{{ book.id }}" id="flexCheckDefault">
                </div>
            </td>
            <td><a href="{{ url_for('repair.books_list', name=book.title) }}">X</a></td>
            <td>{{ book.isbn }}</td>
            <td><a href="{{ url_for('repair.book_details', id=book.id) }}">{{ book.title }}</a></td>
            <td>{{ book.authors }}</td> {#trzeba będzie autorów jako obiekty #}
            <td> {% if book.publisher_id %}
                    <a href="{{ url_for('repair.publisher_details', id=book.publisher_id) }}" target="_blank">{{ book.publisher }}</a>
            {% endif %}</td>
            <td> {% if book.serie_id %}
                    <a href="{{ url_for('repair.serie_details', id=book.serie_id) }}" target="_blank">{{ book.serie }}</a>
            {% endif %}</td>
            <td> {% if book.city_id %}
                    <a href="{{ url_for('repair.city_details', id=book.city_id) }}" target="_blank">{{ book.city }}</a>
            {% endif %}</td>
            <td>{{ book.pub_year }}</td>
            <td>{{ book.copies_count }}</td>
            {% if book.incorrect %}
                <td style="color: red;">{{ book.incorrect }}</td>
            {% else %}
                <td>
                    <a href="{{ url_for('staff.toggle_incorrect', id_=book.id, m='book', next=request.path)}}">X</a>
                </td>
            {% endif %}
            <td>{{ book.approuved }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
<button type="submit" class="btn btn-info">Merge</button>
</form>
{% if b %}
{{ render_pagination(b) }}
{% endif %}
{% endblock %}    
